!function($,window,document,undefined){var pluginName="table2excel",defaults={exclude:".noExl",name:"Table2Excel",filename:"table2excel",fileext:".xlsx",exclude_img:!0,exclude_links:!0,exclude_collection:!0,exclude_inputs:!0,preserveColors:!1};function Plugin(element,options){this.element=element,this.settings=$.extend({},defaults,options),this._defaults=defaults,this._name=pluginName,this.init()}function getFileName(settings){return settings.filename?settings.filename:"table2excel"}function exclude_img(string){var _patt=/(\s+alt\s*=\s*"([^"]*)"|\s+alt\s*=\s*`([^`]*)`)/i;return string.replace(/<img[^>]*>/gi,(function myFunction(x){var res=_patt.exec(x);return null!==res&&res.length>=2?res[2]:""}))}function exclude_collection(string) {string = string.replace(/<span[^>]*>|<\/span>/gi, "");string = string.replace(/<a[^>]*>|<\/a>/gi, "");string = string.replace(/<i[^>]*>|<\/i>/gi, "");string = string.replace(/View/gi, "");string = string.replace(/Restore/gi, "");string = string.replace(/Delete/gi, "");string = string.replace(/Edit/gi, "");string = string.replace(/Duplicate/gi, "");return string.trim();}function exclude_links(string){return string.replace(/<a[^>]*>|<\/a>/gi,"")}function exclude_inputs(string){var _patt=/(\s+value\s*=\s*"([^"]*)"|\s+value\s*=\s*`([^`]*)`)/i;return string.replace(/<input[^>]*>|<\/input>/gi,(function myFunction(x){var res=_patt.exec(x);return null!==res&&res.length>=2?res[2]:""}))}Plugin.prototype={init:function(){var e=this,utf8Heading=`<meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">`;e.template={head:`<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">`+utf8Heading+"<head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>",sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},e.tableRows=[];var additionalStyles="",compStyle=null;$(e.element).each((function(i,o){var tempRows="";$(o).find("tr").not(e.settings.exclude).each((function(i,p){additionalStyles="",e.settings.preserveColors&&(compStyle=getComputedStyle(p),additionalStyles+=compStyle&&compStyle.backgroundColor?"background-color: "+compStyle.backgroundColor+";":"",additionalStyles+=compStyle&&compStyle.color?"color: "+compStyle.color+";":""),tempRows+="<tr style=`"+additionalStyles+"`>",$(p).find("td,th").not(e.settings.exclude).each((function(i,q){additionalStyles="",e.settings.preserveColors&&(compStyle=getComputedStyle(q),additionalStyles+=compStyle&&compStyle.backgroundColor?"background-color: "+compStyle.backgroundColor+";":"",additionalStyles+=compStyle&&compStyle.color?"color: "+compStyle.color+";":"");var rc_rows=$(this).attr("rowspan"),rc_cols=$(this).attr("colspan"),rc_flag;$(q).find(e.settings.exclude).length>0?tempRows+="<td> </td>":(tempRows+="<td",rc_rows>0&&(tempRows+=" rowspan=`"+rc_rows+"` "),rc_cols>0&&(tempRows+=" colspan=`"+rc_cols+"` "),additionalStyles&&(tempRows+=" style=`"+additionalStyles+"`"),tempRows+=">"+$(q).html()+"</td>")})),tempRows+="</tr>"})),e.settings.exclude_img&&(tempRows=exclude_img(tempRows)),e.settings.exclude_links&&(tempRows=exclude_links(tempRows)),e.settings.exclude_inputs&&(tempRows=exclude_inputs(tempRows)),e.settings.exclude_collection && (tempRows = exclude_collection(tempRows)),e.tableRows.push(tempRows)})),e.tableToExcel(e.tableRows,e.settings.name,e.settings.sheetName)},tableToExcel:function(table,name,sheetName){var e=this,fullTemplate="",i,link,a,isIE;for(i in e.format=function(s,c){return s.replace(/{(\w+)}/g,(function(m,p){return c[p]}))},sheetName=void 0===sheetName?"Sheet":sheetName,e.ctx={worksheet:name||"Worksheet",table:table,sheetName:sheetName},fullTemplate=e.template.head,$.isArray(table)&&Object.keys(table).forEach((function(i){fullTemplate+=e.template.sheet.head+sheetName+i+e.template.sheet.tail})),fullTemplate+=e.template.mid,$.isArray(table)&&Object.keys(table).forEach((function(i){fullTemplate+=e.template.table.head+"{table"+i+"}"+e.template.table.tail})),fullTemplate+=e.template.foot,table)e.ctx["table"+i]=table[i];if(delete e.ctx.table,-1!==navigator.appVersion.indexOf("MSIE 10")||-1!==navigator.userAgent.indexOf("Trident")&&-1!==navigator.userAgent.indexOf("rv:11"))if("undefined"!=typeof Blob){fullTemplate=[fullTemplate=e.format(fullTemplate,e.ctx)];var blob1=new Blob(fullTemplate,{type:"text/html"});window.navigator.msSaveBlob(blob1,getFileName(e.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(e.format(fullTemplate,e.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,getFileName(e.settings));else{var blob=new Blob([e.format(fullTemplate,e.ctx)],{type:"application/vnd.ms-excel"});window.URL=window.URL||window.webkitURL,link=window.URL.createObjectURL(blob),(a=document.createElement("a")).download=getFileName(e.settings),a.href=link,document.body.appendChild(a),a.click(),document.body.removeChild(a)}return!0}},$.fn.table2excel=function(options){var e=this;return e.each((function(){$.data(e,"plugin_table2excel")||$.data(e,"plugin_table2excel",new Plugin(this,options))})),e}}(jQuery,window,document);